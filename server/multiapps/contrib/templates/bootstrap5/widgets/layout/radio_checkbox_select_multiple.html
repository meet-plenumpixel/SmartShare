{% load crispy_forms_filters %}
{% load l10n %}

<div {% if field_class %}class="{{ field_class }}"{% endif %}{% if flat_attrs %} {{ flat_attrs }}{% endif %}>
  <div class="dropdown-container checkboc_select_multiple form-control{% if field.errors %} is-invalid{% endif %}">
    <div class="dropdown-button noselect w-100">
      <div class="dropdown-label">Selected</div>
      <div class="dropdown-quantity">(<span class="quantity">0</span>)</div>
      <i class="fa fa-chevron-down"></i>
    </div>
    <div class="dropdown-list" style="display: none;">
      <input type="search" placeholder="Search states" class="form-control dropdown-search"/>
      <ul>
        {% for group, options, index in field|optgroups %}
          {% if group %}<strong>{{ group }}</strong>{% endif %}
          {% for option in options %}
            <li class="form-check{% if inline_class %} form-check-inline{% endif %}" {#% include "bootstrap5/widgets/layout/attrs.html" with widget=option %#}>
                <label for="{{ option.attrs.id }}" class="checkbox-wrap form-check-label">
                  <input type="{{option.type}}" class="form-check-input" name="{{ field.html_name }}" value="{{ option.value|unlocalize }}" id="{{ option.attrs.id }}">
                  <span for="{{ field.html_name }}"> {{ option.label|unlocalize }} </span>
                  <span class="checkmark"></span>
                </label>
            </li>
          {% endfor %}
        {% endfor %}
      </ul>
    </div>
  </div>

  {% if field.errors %}
    {% if inline_class %}
      {% for error in field.errors %}
        <p id="error_{{ forloop.counter }}_{{ field.auto_id }}" class="text-danger mb-0"><small><strong>{{ error }}</strong></small></p>
      {% endfor %}
    {% else %}
      {% include 'bootstrap5/widgets/layout/field_errors_block.html' %}
    {% endif %}
  {% endif %}
  {% include 'bootstrap5/widgets/layout/help_text.html' %}

</div>
